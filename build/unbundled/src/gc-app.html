<html><head><link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">

<link rel="import" href="../bower_components/parallax-container/parallax-container.html">
<link rel="import" href="vimeo-player.html">
<link rel="import" href="image-slider.html">
<link rel="import" href="icon-toggle.html">

<link rel="import" href="gc-icons.html">
<link rel="import" href="gc-styles.html">


</head><body><dom-module id="gc-app">
  <template>
    <style include="gc-styles">
      :host {
        --app-primary-color: white;
        --app-secondary-color: black;

        display: block;
        padding: 0px;
        overflow: hidden;

        iron-image {
          --iron-image-width: 100%;
        }
      }
    </style>
    <style is="custom-style">
      paper-dialog.carousel-dialog {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        padding: 0;
        margin: 50px;
        overflow: hidden;
        background-color: #000;
      }

      .closeButton {
          position: absolute;
          top: 0;
          left: auto;
          right: 0;
          bottom: auto;
          background-color: var(--paper-grey-300);
          opacity: 0.75;
          color: var(--paper-grey-700);
          border-radius: 20px;
          margin: 10px;
          color: #fff;
      }

      .era {
          
      }

      ._1_1_admin{
        display: var(--display1_1, inline);
        background-color: white;
      }

      ._1_2_campus{
        display: var(--display1_2, inline);
        background-color: green;
      }

      ._1_3_students{
        display: var(--display1_3, inline);
        background-color: blue;
      }

      ._1_4_teaching{
        display: var(--display1_4, inline);
        background-color: red;
      }

      ._2_1_art_and_design{
        display: var(--display2_1, inline);
      }

      ._2_2_science_and_technology{
        display: var(--display2_2, inline);
      }

      ._2_3_business{
        display: var(--display2_3, inline);
      }

      ._2_4_research{
        display: var(--display2_4, inline);
      }

      ._2_5_multidisciplinarity{
        display: var(--display2_5, inline);
      }

      ._3_1_entrepreneurship{
        display: var(--display3_1, inline);
      }

      ._3_2_corporate_collaboration{
        display: var(--display3_2, inline);
      }

      ._3_3_academic_collaboration{
        display: var(--display3_3, inline);
      }

      ._4_1_global_event{
        display: var(--display4_1, inline);
      }

      ._4_2_regional_event{
        display: var(--display4_2, inline);
      }

    </style>



    
    <div class="container flex-horizontal">
      <div style="position: relative; left: 0; top: 0; min-width: 120px">
        
        <img src="/pictures/alpha.png" style="position: absolute; top: 0px; left: 0px">
      </div>
      <div class="flexchild">
        <img src="/pictures/title_FIN.png" style="position: relative; top: 20px; left: 0; margin: 60px 0px 60px 0px">

          <div class="container flex-horizontal">
            <div class="flexchild">
              
              <h1 class="info">Tervetuloa!</h1>
              <p class="info">Aalto-yliopiston aikajana kertoo visuaalisin keinoin tarinoita Muutoksentekijöistä – henkilöistä, tapahtumista tai innovaatioista – Aallon tai sen edeltäjien piirissä. Muutoksentekijöistä, joilla on ollut suuri vaikutus suomalaisen yhteiskunnan kehitykseen.</p>
              <br>
              <p class="info">Aikajana kehittyy vähitellen, joten pyydämme myös sinun panostasi Aallon tarinaan alkaen vuodesta 1849. Kerro visiosi Aallon tulevaisuudesta. Jakaaksesi ajatuksesi liiku aikajanalla haluamaasi vuoteen ja ehdota lisättäväksi aihetta ja taustatietoja. Voit myös kirjoittaa kommenttikenttään anekdootteja jo kuvatuista aiheista. Odotamme panostasi, suurkiitos siitä etukäteen!</p>

            </div>

            <div class="flexchild">
              
              <h1 class="info">Video of the month</h1>
              <vimeo-player id="videoOfTheMonth" videoid="39189423"></vimeo-player>
              <p class="info">Video Title</p>
              <p class="info">Video Description</p>
            </div>
          </div>

      </div>
    </div>

    
    
    <template is="dom-repeat" items="{{eras}}" sort="sortEras">

      <div class="era" style="background:url([[item.images.0.url]]) no-repeat">

        <p class="eraName"> {{item.name}} </p>
        

        
        <template is="dom-repeat" items="{{item.events}}" sort="sortEvents" as="eventItem">

          <div class$="[[eventItem.type]]">

           <div class="container flex-horizontal">

            
            <div class="year">
              <template is="dom-if" if="{{yearIsFirstInDecade(eventItem.from)}}">
                <div style="font-weight: bold">{{eventYear(eventItem.from)}}</div>
              </template>
              <template is="dom-if" if="{{!yearIsFirstInDecade(eventItem.from)}}">
                {{eventYear(eventItem.from)}}
              </template>
            </div>

            
            
              <div class="commentColumn">
                <div class="comment" id$="comment{{eventItem.id}}" style="display: none">
                  <div class="flexchild">

                     <div class="comment-container">

                        <div class="comment-icon">
                          <iron-icon icon="comment"></iron-icon>
                        </div>

                        <div class="comment-text">
                          <template is="dom-repeat" items="{{eventItem.latestPublicComments}}" as="comment">
                            <p>{{comment.notes}}</p>
                            <p style="font-size: 11px">{{comment.name}}</p>
                          </template>
                        </div>

                    </div>

                  </div>
                  <div class="leftArrow">
                    <img src="/pictures/arrowLeft.png" style="position: relative; top: 0; left: 0; margin: 12px">
                  </div>
                </div>
              </div>
            

            
            <div class="flexchild">
              <paper-card>
                <div class="event" id="event">
                  <div class="event-header" style$="background-color: [[eventColour(eventItem.type)]];">
                    <paper-button on-tap="handleEventCollapse" style="max-width: 330px; font-family: 'Roboto Condensed', sans-serif; font-weight: bold; text-transform: none">
                      <iron-icon src="/icns/{{eventItem.type}}.svg" style="margin-right: 8px"></iron-icon>
                      <span class="buttontext">{{eventItem.name}}</span>
                    </paper-button>
                  </div>
                  <iron-collapse id$="collapse{{eventItem.id}}" style$="width:100%;">
                      
                      <template is="dom-if" if="{{!arrayEmpty(eventItem.images)}}">
                        <div class="event-image">
                          <iron-image style="width: 100%; height: 240px" sizing="cover" src="[[eventItem.images.0.url]]"></iron-image>
                          

                          <paper-icon-button src="/icns/fullscreen.svg" on-tap="handleEventCarousel"></paper-icon-button>

                          <paper-dialog id="carouselDialog[[eventItem.id]]" class="carousel-dialog" modal="">



                            <image-slider images="{{formatImageArray(eventItem.images)}}" captions="{{formatCaptionArray(eventItem.images)}}"></image-slider>
                            
                              <paper-icon-button class="closeButton" src="/icns/close.svg" dialog-confirm="" autofocus=""></paper-icon-button>
                            
                          </paper-dialog>

                        </div>
                      </template>

                      

                      <div class="event-text">
                         
                         <p style="white-space: pre-line">{{eventItem.notes}}
                         </p>
                      </div>
                      <div class="event-footer">
                           <paper-button on-tap="handleEventComment">Comment</paper-button>

                          

                          <paper-dialog id="commentDialog[[eventItem.id]]" modal="">
                            <p>Please enter your name, email and comment below.</p>
                            <form is="iron-form" id="form[[eventItem.id]]" method="post" content-type="application/json" action="{{getCommentURL}}" on-iron-form-response="handleResponseComment">
                                  <paper-input name="name" label="Name" char-counter="" maxlength="160" auto-validate="" error-message="Please enter your name"></paper-input>
                                  <paper-input name="email" label="Email" char-counter="" maxlength="160" auto-validate="" error-message="Please enter your email"></paper-input>
                                  <paper-input name="notes" label="Comment" char-counter="" maxlength="160" auto-validate="" error-message="Please enter a comment"></paper-input>
                                  <input type="hidden" name="commentedItemId" value="[[eventItem.id]]">
                                  <br>
                                  <paper-button dialog-dismiss="">Cancel</paper-button>
                                  <paper-button raised="" autofocus="" on-tap="submitForm">Submit</paper-button>
                            </form>
                            <div class="buttons">

                            </div>

                          </paper-dialog>

                      </div>
                  </iron-collapse>
                </div>
              </paper-card>
            </div>

            
            <div class="flexchild">
              <div class="associationColumn">
                <div class="associations" id$="associations{{eventItem.id}}" style="display: none">
                  <div class="rightArrow">
                    <img src="/pictures/arrowRight.png" style="position: relative; top: 0; left: 0; margin: 12px">
                  </div>
                  <div class="flexchild">
                    <template is="dom-repeat" items="{{eventItem.associatedItems}}" as="association">
                      <paper-card>
                        <div class="association">
                          <div class="association-header" style$="background-color: {{eventColour(association.type)}};">
                            <paper-button id$="{{association.id}}" on-tap="handleAssociationCollapse" style="max-width: 330px; font-family: 'Roboto Condensed', sans-serif; font-weight: bold; text-transform: none">
                              
                              <iron-icon src="/icns/{{association.type}}.svg" style="margin-right: 8px"></iron-icon>
                              <span class="buttontext">{{association.name}}</span>
                            </paper-button>
                          </div>
                          <iron-collapse id$="associationCollapse{{eventItem.id}}{{association.id}}" style="width:100%">

                              <template is="dom-if" if="{{!arrayEmpty(association.images)}}">
                                <div class="association-image">
                                  <iron-image style="width: 100%; height: 240px" sizing="cover" src="{{association.images.0.url}}"></iron-image>

                                </div>
                              </template>

                              <div class="association-text">
                                 
                                 <p>{{association.notes}}</p>
                              </div>
                          </iron-collapse>

                        </div>
                      </paper-card>
                    </template>
                  </div>
                </div>
              </div>
            </div>

           </div>
          </div>

          </template>

        </div>

    </template>

    
    <paper-toast id="toastFilters" duration="0" text="Filters ">
      <paper-icon-button id="1_1" src="/icns/_1_1_admin.svg" on-tap="handleFilter" data-args="1_1"></paper-icon-button>
      <paper-icon-button id="1_2" src="/icns/_1_2_campus.svg" on-tap="handleFilter" data-args="1_2"></paper-icon-button>
      <paper-icon-button id="1_3" src="/icns/_1_3_students.svg" on-tap="handleFilter" data-args="1_3"></paper-icon-button>
      <paper-icon-button id="1_4" src="/icns/_1_4_teaching.svg" on-tap="handleFilter" data-args="1_4"></paper-icon-button>
      <paper-icon-button id="2_1" src="/icns/_2_1_art_and_design.svg" on-tap="handleFilter" data-args="2_1"></paper-icon-button>
      <paper-icon-button id="2_2" src="/icns/_2_2_science_and_technology.svg" on-tap="handleFilter" data-args="2_2"></paper-icon-button>
      <paper-icon-button id="2_3" src="/icns/_2_3_business.svg" on-tap="handleFilter" data-args="2_3"></paper-icon-button>
      <paper-icon-button id="2_4" src="/icns/_2_4_research.svg" on-tap="handleFilter" data-args="2_4"></paper-icon-button>
      <paper-icon-button id="2_5" src="/icns/_2_5_multidisciplinarity.svg" on-tap="handleFilter" data-args="2_5"></paper-icon-button>
      <paper-icon-button id="3_1" src="/icns/_3_1_entrepreneurship.svg" on-tap="handleFilter" data-args="3_1"></paper-icon-button>
      <paper-icon-button id="3_2" src="/icns/_3_2_corporate_collaboration.svg" on-tap="handleFilter" data-args="3_2"></paper-icon-button>
      <paper-icon-button id="3_3" src="/icns/_3_3_academic_collaboration.svg" on-tap="handleFilter" data-args="3_3"></paper-icon-button>
      <paper-icon-button id="4_1" src="/icns/_4_1_global_event.svg" on-tap="handleFilter" data-args="4_1"></paper-icon-button>
      <paper-icon-button id="4_2" src="/icns/_4_2_regional_event.svg" on-tap="handleFilter" data-args="4_2"></paper-icon-button>
    </paper-toast>

    

    
    
    <iron-ajax id="requestEras" url="" handle-as="json" on-response="handleResponseEras">
    </iron-ajax>

  </template>

  <script>Polymer({is:"gc-app",properties:{domain:{type:String,value:"https://deepamehta.aalto.fi"},languauge:{type:String,value:"fi"},version:{type:String,value:"v2"},filter1_1:{type:Boolean,value:!0},filter1_2:{type:Boolean,value:!0},filter1_3:{type:Boolean,value:!0},filter1_4:{type:Boolean,value:!0},filter2_1:{type:Boolean,value:!0},filter2_2:{type:Boolean,value:!0},filter2_3:{type:Boolean,value:!0},filter2_4:{type:Boolean,value:!0},filter2_5:{type:Boolean,value:!0},filter3_1:{type:Boolean,value:!0},filter3_2:{type:Boolean,value:!0},filter3_3:{type:Boolean,value:!0},filter4_1:{type:Boolean,value:!0},filter4_2:{type:Boolean,value:!0}},ready:function(){this.$.requestEras.url=this.domain+"/gamechangers/"+this.version+"/"+this.languauge+"/eras",this.$.requestEras.generateRequest(),this.$.toastFilters.open()},arrayEmpty:function(e){return 0==e.length},formatImageArray:function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n].url;return t},formatCaptionArray:function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n].caption;return t},justText:function(e){var t=e.replace(/<img[^>]*>/g,"");return t},stripURL:function(e){return console.log("striping : "+e),e=e.replace(/%2F/gi,"/"),console.log("stripped : "+e),e},getCommentURL:function(){return console.log("domain in getCommentURL : "+this.domain),this.domain+"/gamechangers/v1/comment"},handleResponseEvents:function(e){console.log(e.detail.response),this.events=e.detail.response},handleResponseEras:function(e){console.log(e.detail.response),this.eras=e.detail.response},sortEvents:function(e,t){return parseFloat(t.from)-parseFloat(e.from)},sortEras:function(e,t){return parseFloat(t.from)-parseFloat(e.from)},handleFilter:function(e){var t,n="--display"+e.target.dataset.args;switch(e.target.dataset.args){case"1_1":t=this.filter1_1?"none":"inline",this.filter1_1=!this.filter1_1;break;case"1_2":t=this.filter1_2?"none":"inline",this.filter1_2=!this.filter1_2;break;case"1_3":t=this.filter1_3?"none":"inline",this.filter1_3=!this.filter1_3;break;case"1_4":t=this.filter1_4?"none":"inline",this.filter1_4=!this.filter1_4;break;case"2_1":t=this.filter2_1?"none":"inline",this.filter2_1=!this.filter2_1;break;case"2_2":t=this.filter2_2?"none":"inline",this.filter2_2=!this.filter2_2;break;case"2_3":t=this.filter2_3?"none":"inline",this.filter2_3=!this.filter2_3;break;case"2_4":t=this.filter2_4?"none":"inline",this.filter2_4=!this.filter2_4;break;case"2_5":t=this.filter2_5?"none":"inline",this.filter2_5=!this.filter2_5;break;case"3_1":t=this.filter3_1?"none":"inline",this.filter3_1=!this.filter3_1;break;case"3_2":t=this.filter3_2?"none":"inline",this.filter3_2=!this.filter3_2;break;case"3_3":t=this.filter3_3?"none":"inline",this.filter3_3=!this.filter3_3;break;case"4_1":t=this.filter4_1?"none":"inline",this.filter4_1=!this.filter4_1;break;case"4_2":t=this.filter4_2?"none":"inline",this.filter4_2=!this.filter4_2}this.customStyle[n]=t,this.updateStyles()},handleEventCollapse:function(e,t,n){var i=e.model.eventItem.id,a="#collapse"+i,r="#comment"+i,s="#associations"+i;this.$$(a).opened?(this.$$(r).style.display="none",this.$$(s).style.display="none"):(this.$$(r).style.display="flex",this.$$(s).style.display="flex"),this.$$(a).toggle()},handleAssociationCollapse:function(e,t,n){var i=e.model.eventItem.id,a=e.model.association.id,r="#associationCollapse"+i+a;this.$$(r).toggle()},handleEventComment:function(e,t,n){var i=e.model.eventItem.id;console.log("open comment dialog for event : "+i);var a="#commentDialog"+i;this.$$(a).open()},handleEventCarousel:function(e,t,n){console.log("full screen tap event");var i=e.model.eventItem.id;console.log("open image carousel dialog for event : "+i);var a="#carouselDialog"+i;this.$$(a).open()},handleResponseComment:function(e){var t=event.model.eventItem.id;console.log("close comment dialog for event : "+t),console.log("comment response : "+JSON.stringify(e.detail.response)),console.log("comment response id "+e.detail.response.id);var n="#commentDialog"+t;this.$$(n).close(),alert("Comment submitted. Thank you.")},submitForm:function(e){var t=e.target.parentElement;t.addEventListener("iron-form-presubmit",function(){this.request.method="PUT",this.request.url="https://deepamehta.aalto.fi/gamechangers/v1/comment",this.request.handleAs="json"}),t.addEventListener("iron-form-error",function(e){alert("Comment failed. Please make sure you entered your name, a comment and a valid email then try again")}),t.submit()},eventColour:function(e){var t;switch(e){case"_1_1_admin":t="#5677FC";break;case"_1_2_campus":t="#5677FC";break;case"_1_3_students":t="#5677FC";break;case"_1_4_teaching":t="#5677FC";break;case"_2_1_art_and_design":t="#EC407A";break;case"_2_2_science_and_technology":t="#EC407A";break;case"_2_3_business":t="#EC407A";break;case"_2_4_research":t="#EC407A";break;case"_2_5_multidisciplinarity":t="#EC407A";break;case"_3_1_entrepreneurship":t="#FF9800";break;case"_3_2_corporate_collaboration":t="#FF9800";break;case"_3_3_academic_collaboration":t="#FF9800";break;case"_4_1_global_event":t="#7ED321";break;case"_4_2_regional_event":t="#7ED321";break;default:t="#9B9B9B"}return t},eventYear:function(e){var t=new Date(e);return t.getFullYear()},yearIsFirstInDecade:function(e){var t=new Date(e),n=t.getFullYear(),i=n.toString(),a=i.substr(i.length-1);return"0"==a}});</script>

</dom-module>
</body></html>